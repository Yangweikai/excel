<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ExcelÁøªËØëÂ∑•ÂÖ∑ - Ê∏ÖÊñ∞Áâà</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üìä</text></svg>">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            color: white;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .main-card {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
            margin-bottom: 30px;
        }

        .card-header {
            background: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%);
            color: white;
            padding: 25px 30px;
            font-size: 1.3rem;
            font-weight: 600;
        }

        .card-body {
            padding: 30px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2d3436;
        }

        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .form-control:focus {
            outline: none;
            border-color: #74b9ff;
            box-shadow: 0 0 0 3px rgba(116, 185, 255, 0.1);
        }

        .file-upload {
            position: relative;
            display: inline-block;
            width: 100%;
        }

        .file-upload input[type=file] {
            position: absolute;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }

        .file-upload-label {
            display: block;
            padding: 15px;
            border: 2px dashed #74b9ff;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #f8f9ff;
        }

        .file-upload-label:hover {
            border-color: #0984e3;
            background: #e3f2fd;
        }

        .file-upload-label i {
            font-size: 2rem;
            color: #74b9ff;
            margin-bottom: 10px;
            display: block;
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }

        .btn-primary {
            background: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(116, 185, 255, 0.3);
        }

        .btn-success {
            background: linear-gradient(135deg, #00b894 0%, #00a085 100%);
            color: white;
        }

        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0, 184, 148, 0.3);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
            box-shadow: none !important;
        }

        .progress-container {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            display: none;
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: #e9ecef;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 15px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #74b9ff 0%, #0984e3 100%);
            border-radius: 10px;
            transition: width 0.3s ease;
            width: 0%;
        }

        .progress-text {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .status-info {
            background: white;
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
            border-left: 4px solid #74b9ff;
        }

        .status-info h4 {
            margin-bottom: 10px;
            color: #2d3436;
        }

        .status-info p {
            margin-bottom: 5px;
            color: #636e72;
        }

        .alert {
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 4px solid;
        }

        .alert-success {
            background: #d4edda;
            border-color: #00b894;
            color: #155724;
        }

        .alert-error {
            background: #f8d7da;
            border-color: #e74c3c;
            color: #721c24;
        }

        .alert-warning {
            background: #fff3cd;
            border-color: #f39c12;
            color: #856404;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .checkbox-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .checkbox-item input[type="checkbox"] {
            width: 16px;
            height: 16px;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #74b9ff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .hidden {
            display: none;
        }

        .download-section {
            text-align: center;
            padding: 20px;
            background: #f8f9ff;
            border-radius: 10px;
            margin-top: 20px;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .card-body {
                padding: 20px;
            }
            
            .grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìä ExcelÁøªËØëÂ∑•ÂÖ∑</h1>
            <p>Êô∫ËÉΩ‰∏≠Ëã±ÊñáÁøªËØëÔºåÊîØÊåÅÊâπÈáèÂ§ÑÁêÜExcelÊñá‰ª∂</p>
        </div>

        <div class="main-card">
            <div class="card-header">
                üìÅ Êñá‰ª∂‰∏ä‰º†‰∏éÈÖçÁΩÆ
            </div>
            <div class="card-body">
                <form id="translationForm">
                    <!-- Êñá‰ª∂‰∏ä‰º† -->
                    <div class="form-group">
                        <label class="form-label">ÈÄâÊã©ExcelÊñá‰ª∂</label>
                        <div class="file-upload">
                            <input type="file" id="excelFile" accept=".xlsx" required>
                            <label for="excelFile" class="file-upload-label">
                                <i>üìÑ</i>
                                <span id="fileLabel">ÁÇπÂáªÈÄâÊã©ExcelÊñá‰ª∂ (.xlsx)</span>
                            </label>
                        </div>
                    </div>

                    <!-- APIÈÖçÁΩÆ -->
                    <div class="grid">
                        <div class="form-group">
                            <label class="form-label">ÁôæÂ∫¶ÁøªËØë App ID</label>
                            <input type="text" id="appId" class="form-control" placeholder="ËØ∑ËæìÂÖ•ÊÇ®ÁöÑÁôæÂ∫¶ÁøªËØëApp ID" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">ÁôæÂ∫¶ÁøªËØë App Key</label>
                            <input type="password" id="appKey" class="form-control" placeholder="ËØ∑ËæìÂÖ•ÊÇ®ÁöÑÁôæÂ∫¶ÁøªËØëApp Key" required>
                        </div>
                    </div>

                    <!-- ÁøªËØëÈÖçÁΩÆ -->
                    <div class="grid">
                        <div class="form-group">
                            <label class="form-label">Ëµ∑ÂßãË°å</label>
                            <input type="number" id="startRow" class="form-control" value="2" min="1">
                        </div>
                        <div class="form-group">
                            <label class="form-label">ÁªìÊùüË°å</label>
                            <input type="number" id="endRow" class="form-control" placeholder="ÁïôÁ©∫Ë°®Á§∫Âà∞Êú´Â∞æ">
                        </div>
                    </div>

                    <!-- Â∑•‰ΩúË°®ÈÄâÊã© -->
                    <div class="form-group">
                        <label class="form-label">ÈÄâÊã©Â∑•‰ΩúË°®</label>
                        <div id="sheetSelection" class="checkbox-group">
                            <div class="checkbox-item">
                                <input type="checkbox" id="selectAll" checked>
                                <label for="selectAll">ÂÖ®ÈÄâ</label>
                            </div>
                        </div>
                    </div>

                    <!-- ÂàóÈÄâÊã© -->
                    <div class="form-group">
                        <label class="form-label">ÈÄâÊã©Ë¶ÅÁøªËØëÁöÑÂàó</label>
                        <div id="columnSelection" class="checkbox-group">
                            <!-- Âä®ÊÄÅÁîüÊàêÂàóÈÄâÈ°π -->
                        </div>
                    </div>

                    <!-- Êìç‰ΩúÊåâÈíÆ -->
                    <div style="text-align: center; margin-top: 30px;">
                        <button type="submit" id="startBtn" class="btn btn-primary">
                            <span id="startBtnText">üöÄ ÂºÄÂßãÁøªËØë</span>
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- ËøõÂ∫¶ÊòæÁ§∫ -->
        <div class="main-card" id="progressCard">
            <div class="card-header">
                üìà ÁøªËØëËøõÂ∫¶
            </div>
            <div class="card-body">
                <div class="progress-container" id="progressContainer">
                    <div class="progress-text">
                        <span>ÁøªËØëËøõÂ∫¶</span>
                        <span id="progressPercent">0%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    
                    <div class="status-info">
                        <h4>üìä ÁªüËÆ°‰ø°ÊÅØ</h4>
                        <p>ÊÄªÂçïÂÖÉÊ†ºÊï∞: <span id="totalCells">0</span></p>
                        <p>ÈúÄË¶ÅÁøªËØë: <span id="translatableCells">0</span></p>
                        <p>Â∑≤ÁøªËØë: <span id="translatedCells">0</span></p>
                        <p>Â∑≤Ë∑≥Ëøá: <span id="skippedCells">0</span></p>
                        <p>ÈîôËØØ: <span id="errorCells">0</span></p>
                        <p>ÂΩìÂâçÂ∑•‰ΩúË°®: <span id="currentSheet">-</span></p>
                        <p>ÂΩìÂâçÂçïÂÖÉÊ†º: <span id="currentCell">-</span></p>
                        <p>ËÄóÊó∂: <span id="elapsedTime">0Áßí</span></p>
                    </div>
                    
                    <div class="status-info">
                        <h4>üí¨ Áä∂ÊÄÅ‰ø°ÊÅØ</h4>
                        <p id="statusMessage">ÂáÜÂ§áÂ∞±Áª™</p>
                    </div>
                </div>

                <div class="download-section hidden" id="downloadSection">
                    <h3>‚úÖ ÁøªËØëÂÆåÊàêÔºÅ</h3>
                    <p>ÊÇ®ÁöÑÊñá‰ª∂Â∑≤ÊàêÂäüÁøªËØëÂÆåÊàêÔºåÂèØ‰ª•‰∏ãËΩΩ‰∫Ü„ÄÇ</p>
                    <a href="#" id="downloadBtn" class="btn btn-success">üì• ‰∏ãËΩΩÁøªËØëÂêéÁöÑÊñá‰ª∂</a>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentTaskId = null;
        let progressInterval = null;
        let uploadedFilePath = null; // Â≠òÂÇ®‰∏ä‰º†ÂêéÁöÑÊñá‰ª∂Ë∑ØÂæÑ

        // Êñá‰ª∂‰∏ä‰º†Â§ÑÁêÜ
        document.getElementById('excelFile').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                document.getElementById('fileLabel').textContent = file.name;
                uploadFile(file);
            }
        });

        // ÂÖ®ÈÄâ/ÂèñÊ∂àÂÖ®ÈÄâÂ∑•‰ΩúË°®
        document.getElementById('selectAll').addEventListener('change', function(e) {
            const checkboxes = document.querySelectorAll('input[name="sheets"]');
            checkboxes.forEach(cb => cb.checked = e.target.checked);
        });

        // Ë°®ÂçïÊèê‰∫§
        document.getElementById('translationForm').addEventListener('submit', function(e) {
            e.preventDefault();
            startTranslation();
        });

        // ‰∏ä‰º†Êñá‰ª∂
        function uploadFile(file) {
            const formData = new FormData();
            formData.append('file', file);

            fetch('/upload', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showAlert('Êñá‰ª∂‰∏ä‰º†ÊàêÂäüÔºÅ', 'success');
                    uploadedFilePath = data.filepath; // ‰øùÂ≠òÊñá‰ª∂Ë∑ØÂæÑ
                    populateSheetSelection(data.sheet_names);
                    populateColumnSelection(data.columns);
                } else {
                    showAlert('Êñá‰ª∂‰∏ä‰º†Â§±Ë¥•: ' + data.error, 'error');
                }
            })
            .catch(error => {
                showAlert('‰∏ä‰º†Âá∫Èîô: ' + error.message, 'error');
            });
        }

        // Â°´ÂÖÖÂ∑•‰ΩúË°®ÈÄâÊã©
        function populateSheetSelection(sheetNames) {
            const container = document.getElementById('sheetSelection');
            container.innerHTML = '<div class="checkbox-item"><input type="checkbox" id="selectAll" checked><label for="selectAll">ÂÖ®ÈÄâ</label></div>';
            
            sheetNames.forEach(sheet => {
                const div = document.createElement('div');
                div.className = 'checkbox-item';
                div.innerHTML = `
                    <input type="checkbox" name="sheets" value="${sheet}" checked>
                    <label>${sheet}</label>
                `;
                container.appendChild(div);
            });

            // ÈáçÊñ∞ÁªëÂÆöÂÖ®ÈÄâ‰∫ã‰ª∂
            document.getElementById('selectAll').addEventListener('change', function(e) {
                const checkboxes = document.querySelectorAll('input[name="sheets"]');
                checkboxes.forEach(cb => cb.checked = e.target.checked);
            });
        }

        // Â°´ÂÖÖÂàóÈÄâÊã©
        function populateColumnSelection(columns) {
            const container = document.getElementById('columnSelection');
            container.innerHTML = '';
            
            columns.forEach(col => {
                const div = document.createElement('div');
                div.className = 'checkbox-item';
                div.innerHTML = `
                    <input type="checkbox" name="columns" value="${col}">
                    <label>${col}</label>
                `;
                container.appendChild(div);
            });
        }

        // ÂºÄÂßãÁøªËØë
        function startTranslation() {
            if (!uploadedFilePath) {
                showAlert('ËØ∑ÂÖà‰∏ä‰º†ExcelÊñá‰ª∂', 'warning');
                return;
            }

            const formData = {
                filepath: uploadedFilePath, // ‰ΩøÁî®ÂÆåÊï¥ÁöÑÊñá‰ª∂Ë∑ØÂæÑ
                app_id: document.getElementById('appId').value,
                app_key: document.getElementById('appKey').value,
                start_row: parseInt(document.getElementById('startRow').value) || 1,
                end_row: parseInt(document.getElementById('endRow').value) || null,
                sheet_names: Array.from(document.querySelectorAll('input[name="sheets"]:checked')).map(cb => cb.value),
                columns: Array.from(document.querySelectorAll('input[name="columns"]:checked')).map(cb => cb.value)
            };

            if (formData.sheet_names.length === 0) {
                showAlert('ËØ∑Ëá≥Â∞ëÈÄâÊã©‰∏Ä‰∏™Â∑•‰ΩúË°®', 'warning');
                return;
            }

            if (formData.columns.length === 0) {
                showAlert('ËØ∑Ëá≥Â∞ëÈÄâÊã©‰∏ÄÂàóËøõË°åÁøªËØë', 'warning');
                return;
            }

            // Á¶ÅÁî®ÂºÄÂßãÊåâÈíÆ
            const startBtn = document.getElementById('startBtn');
            const startBtnText = document.getElementById('startBtnText');
            startBtn.disabled = true;
            startBtnText.innerHTML = '<span class="loading"></span> ÂêØÂä®‰∏≠...';

            fetch('/start_translation', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(formData)
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    currentTaskId = data.task_id;
                    showProgress();
                    startProgressPolling();
                } else {
                    showAlert('ÂêØÂä®ÁøªËØëÂ§±Ë¥•: ' + data.error, 'error');
                    resetStartButton();
                }
            })
            .catch(error => {
                showAlert('ÂêØÂä®Âá∫Èîô: ' + error.message, 'error');
                resetStartButton();
            });
        }

        // ÊòæÁ§∫ËøõÂ∫¶
        function showProgress() {
            document.getElementById('progressCard').style.display = 'block';
            document.getElementById('progressContainer').style.display = 'block';
            document.getElementById('downloadSection').classList.add('hidden');
            
            // ÈáçÁΩÆËøõÂ∫¶Êù°Áä∂ÊÄÅ
            document.getElementById('progressPercent').textContent = '0%';
            document.getElementById('progressFill').style.width = '0%';
            document.getElementById('progressFill').style.background = 'linear-gradient(90deg, #74b9ff 0%, #0984e3 100%)';
            document.getElementById('totalCells').textContent = '0';
            document.getElementById('translatableCells').textContent = '0';
            document.getElementById('translatedCells').textContent = '0';
            document.getElementById('skippedCells').textContent = '0';
            document.getElementById('errorCells').textContent = '0';
            document.getElementById('currentSheet').textContent = '-';
            document.getElementById('currentCell').textContent = '-';
            document.getElementById('elapsedTime').textContent = '0Áßí';
            document.getElementById('statusMessage').textContent = 'Ê≠£Âú®ÂêØÂä®ÁøªËØë‰ªªÂä°...';
        }

        // ÂºÄÂßãËΩÆËØ¢ËøõÂ∫¶
        function startProgressPolling() {
            if (progressInterval) {
                clearInterval(progressInterval);
            }
            
            progressInterval = setInterval(() => {
                if (currentTaskId) {
                    fetch(`/progress/${currentTaskId}`)
                        .then(response => response.json())
                        .then(data => {
                            updateProgress(data);
                            
                            if (data.status === 'completed' || data.status === 'failed') {
                                clearInterval(progressInterval);
                                if (data.status === 'completed') {
                                    showDownloadSection(data.output_file);
                                }
                                resetStartButton();
                            }
                        })
                        .catch(error => {
                            console.error('Ëé∑ÂèñËøõÂ∫¶Â§±Ë¥•:', error);
                        });
                }
            }, 1000);
        }

        // Êõ¥Êñ∞ËøõÂ∫¶ÊòæÁ§∫
        function updateProgress(data) {
            // Êõ¥Êñ∞ËøõÂ∫¶Êù°
            let progressPercent = data.progress || 0;
            // Á°Æ‰øùËøõÂ∫¶‰∏çË∂ÖËøá100%
            progressPercent = Math.min(100, Math.max(0, progressPercent));
            
            document.getElementById('progressPercent').textContent = progressPercent + '%';
            document.getElementById('progressFill').style.width = progressPercent + '%';
            
            // Êõ¥Êñ∞ÁªüËÆ°‰ø°ÊÅØ
            const totalCells = data.total_cells || 0;
            const translatedCells = data.translated_cells || 0;
            const skippedCells = data.skipped_cells || 0;
            const errorCells = data.error_cells || 0;
            
            // ËÆ°ÁÆóÈúÄË¶ÅÁøªËØëÁöÑÂçïÂÖÉÊ†ºÊï∞ÔºàÊÄªÂçïÂÖÉÊ†ºÊï∞ - Â∑≤Ë∑≥ËøáÁöÑÔºâ
            const translatableCells = totalCells - skippedCells;
            
            document.getElementById('totalCells').textContent = totalCells;
            document.getElementById('translatableCells').textContent = translatableCells;
            document.getElementById('translatedCells').textContent = translatedCells;
            document.getElementById('skippedCells').textContent = skippedCells;
            document.getElementById('errorCells').textContent = errorCells;
            document.getElementById('currentSheet').textContent = data.current_sheet || '-';
            document.getElementById('currentCell').textContent = data.current_cell || '-';
            document.getElementById('elapsedTime').textContent = (data.elapsed_time || 0) + 'Áßí';
            
            // ËÆ°ÁÆóÁøªËØëËøõÂ∫¶ÁôæÂàÜÊØîÔºàÂè™ËÄÉËôëÂÆûÈôÖÁøªËØëÁöÑÂçïÂÖÉÊ†ºÔºâ
            const actualTranslated = translatedCells + errorCells;
            
            let translationProgress = 0;
            if (translatableCells > 0) {
                translationProgress = Math.min(100, Math.round((actualTranslated / translatableCells) * 100));
            }
            
            // Êõ¥Êñ∞Áä∂ÊÄÅ‰ø°ÊÅØÔºåÊòæÁ§∫ÁøªËØëËøõÂ∫¶
            let statusMessage = data.message || 'Â§ÑÁêÜ‰∏≠...';
            if (data.status === 'running' && translatableCells > 0) {
                statusMessage += ` | ÁøªËØëËøõÂ∫¶: ${translationProgress}%`;
            }
            document.getElementById('statusMessage').textContent = statusMessage;
            
            // Ê†πÊçÆÁä∂ÊÄÅÊõ¥Êñ∞ËøõÂ∫¶Êù°È¢úËâ≤
            const progressFill = document.getElementById('progressFill');
            if (data.status === 'failed') {
                progressFill.style.background = 'linear-gradient(90deg, #e74c3c 0%, #c0392b 100%)';
            } else if (data.status === 'completed') {
                progressFill.style.background = 'linear-gradient(90deg, #00b894 0%, #00a085 100%)';
            } else {
                progressFill.style.background = 'linear-gradient(90deg, #74b9ff 0%, #0984e3 100%)';
            }
            
            // Ë∞ÉËØï‰ø°ÊÅØ
            if (progressPercent > 100) {
                console.warn('ËøõÂ∫¶ÂºÇÂ∏∏:', {
                    progress: data.progress,
                    totalCells: totalCells,
                    translatableCells: translatableCells,
                    translatedCells: translatedCells,
                    skippedCells: skippedCells,
                    errorCells: errorCells,
                    translationProgress: translationProgress
                });
            }
        }

        // ÊòæÁ§∫‰∏ãËΩΩÂå∫Âüü
        function showDownloadSection(outputFile) {
            document.getElementById('downloadSection').classList.remove('hidden');
            document.getElementById('downloadBtn').href = `/download/${currentTaskId}`;
            showAlert('ÁøªËØëÂÆåÊàêÔºÅÂèØ‰ª•‰∏ãËΩΩÊñá‰ª∂‰∫Ü„ÄÇ', 'success');
        }

        // ÈáçÁΩÆÂºÄÂßãÊåâÈíÆ
        function resetStartButton() {
            const startBtn = document.getElementById('startBtn');
            const startBtnText = document.getElementById('startBtnText');
            startBtn.disabled = false;
            startBtnText.innerHTML = 'üöÄ ÂºÄÂßãÁøªËØë';
        }

        // ÊòæÁ§∫ÊèêÁ§∫‰ø°ÊÅØ
        function showAlert(message, type) {
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type}`;
            alertDiv.textContent = message;
            
            const container = document.querySelector('.container');
            container.insertBefore(alertDiv, container.firstChild);
            
            setTimeout(() => {
                alertDiv.remove();
            }, 5000);
        }
    </script>
</body>
</html>